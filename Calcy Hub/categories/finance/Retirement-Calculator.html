<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Retirement Calculator üèñÔ∏è - Plan Your Golden Years</title>
    <meta
      name="description"
      content="Modern Neumorphic Retirement Calculator with charts, inflation adjustment, and detailed breakdown. Calculate retirement corpus, monthly savings, and financial independence instantly."
    />
    <meta
      name="keywords"
      content="Retirement Calculator, Retirement Planning, Pension Calculator, Financial Independence, FIRE Calculator, Retirement Corpus, Nest Egg, Retirement Savings"
    />
    <meta name="author" content="Calcy Hub" />
    <link rel="canonical" href="https://calcyhub.com/retirement-calculator" />
    <meta
      property="og:title"
      content="Retirement Calculator üèñÔ∏è - Plan Your Golden Years"
    />
    <meta
      property="og:description"
      content="SEO-friendly Retirement Calculator with charts, inflation adjustment, and detailed breakdown. Calculate your retirement needs instantly."
    />
    <meta property="og:type" content="website" />
    <meta
      property="og:url"
      content="https://calcyhub.com/retirement-calculator"
    />
    <meta
      property="og:image"
      content="https://calcyhub.com/assets/retirement-calculator-preview.png"
    />
    <script
      defer
      src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"
    ></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --primary-bg: #e0e5ec;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: #e0e5ec;
        color: #333;
        padding: 8px;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
      }

      /* Top Bar */
      .header {
        background: var(--primary-bg);
        padding: 8px 10px;
        border: 1px solid #9aa3af;
        border-radius: 10px;
        box-shadow: 0px 0px 16px #a3b1c6, -9px -9px 16px #ffffff;
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 15px;
        flex-wrap: nowrap;
      }

      .back-btn {
        background: var(--primary-bg);
        border: 1px solid #9aa3af;
        padding: 12px 20px;
        border-radius: 12px;
        box-shadow: 4px 4px 8px #a3b1c6, -4px -4px 8px #ffffff;
        cursor: pointer;
        color: #555;
        font-size: 14px;
        transition: all 0.3s;
      }

      .back-btn:hover {
        box-shadow: inset 3px 3px 7px #a3b1c6, inset -3px -3px 7px #ffffff;
      }

      .back-btn:active {
        box-shadow: inset 5px 5px 10px #a3b1c6, inset -5px -5px 10px #ffffff;
      }

      .header-center {
        flex: 1;
        text-align: center;
      }

      .header-center h1 {
        font-size: 28px;
        margin-bottom: 8px;
      }

      .header-actions {
        display: flex;
        gap: 6px;
      }

      .icon-btn {
        background: var(--primary-bg);
        border: 1px solid #9aa3af;
        width: 40px;
        height: 40px;
        border-radius: 10px;
        box-shadow: 4px 4px 8px #a3b1c6, -4px -4px 8px #ffffff;
        cursor: pointer;
        font-size: 18px;
        transition: all 0.3s;
        border: none;
      }

      .icon-btn:active {
        box-shadow: inset 4px 4px 8px #a3b1c6, inset -4px -4px 8px #ffffff;
      }

      /* Main Content */
      .main-content {
        display: grid;
        grid-template-columns: 1fr;
        gap: 30px;
      }

      /* Card Style */
      .card {
        background: var(--primary-bg);
        padding: 20px;
        border-radius: 20px;
        border: 1px solid #89929d;
        box-shadow: 0px 0px 16px #a3b1c6, -9px -9px 16px #ffffff;
      }

      .card h2 {
        font-size: 22px;
        margin-bottom: 15px;
        color: #2c502e;
      }

      /* Input Groups */
      .input-group {
        margin-bottom: 15px;
      }

      .input-group label {
        display: block;
        margin-bottom: 10px;
        font-weight: 600;
        color: #555;
        font-size: 14px;
      }

      input[type="number"],
      select {
        width: 100%;
        padding: 10px 20px;
        border: none;
        border-radius: 12px;
        border: 1px solid #9aa3af;
        background: var(--primary-bg);
        box-shadow: inset 0px 0px 8px #a3b1c6, inset -4px -4px 8px #ffffff;
        font-size: 16px;
        color: #333;
        transition: all 0.3s;
      }

      input[type="number"]:focus,
      select:focus {
        outline: none;
        box-shadow: inset 6px 6px 12px #a3b1c6, inset -6px -6px 12px #ffffff;
      }

      /* Toggle Switch */
      .toggle-group {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
      }

      .toggle-btn {
        flex: 1;
        min-width: 100px;
        padding: 10px 20px;
        border: none;
        border-radius: 12px;
        border: 1px solid #9aa3afdf;
        background: var(--primary-bg);
        box-shadow: 0px 0px 10px #a3b1c6, -5px -5px 10px #ffffff;
        cursor: pointer;
        font-size: 14px;
        color: #555;
        transition: all 0.3s;
      }

      .toggle-btn.active {
        box-shadow: inset 4px 4px 8px #a3b1c6, inset -4px -4px 8px #ffffff;
        color: #3498db;
        font-weight: 600;
        animation: pulse 3s infinite;
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
          box-shadow: 0 1px 4px rgba(80, 99, 103, 0.3);
        }
        50% {
          transform: scale(1.02);
          box-shadow: 0 2px 6px rgba(93, 98, 99, 0.4);
        }
        100% {
          transform: scale(1);
          box-shadow: 0 1px 4px rgba(85, 92, 93, 0.3);
        }
      }

      /* Buttons */
      .btn-group {
        display: flex;
        gap: 15px;
        margin-top: 30px;
        flex-wrap: wrap;
      }

      .calculate-btn {
        flex: 2;
        min-width: 200px;
        padding: 15px 40px;
        border: none;
        border-radius: 15px;
        background: linear-gradient(145deg, #e67e22, #d35400);
        color: var(--primary-bg);
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 6px 6px 12px #a3b1c6, -6px -6px 12px #ffffff;
        transition: all 0.3s;
      }

      .calculate-btn:hover {
        transform: translateY(-2px);
        box-shadow: 8px 8px 16px #a3b1c6, -8px -8px 16px #ffffff;
      }

      .calculate-btn:active {
        transform: translateY(0);
        box-shadow: inset 2px 2px 8px #a04000, inset -4px -4px 8px #ff9a5a;
      }

      .reset-btn {
        flex: 1;
        min-width: 120px;
        padding: 18px 30px;
        border: none;
        border-radius: 15px;
        background: var(--primary-bg);
        color: #555;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 5px 5px 10px #a3b1c6, -5px -5px 10px #ffffff;
        transition: all 0.3s;
      }

      .reset-btn:hover {
        box-shadow: 3px 3px 6px #a3b1c6, -3px -3px 6px #ffffff;
      }

      .reset-btn:active {
        box-shadow: inset 3px 3px 6px #a3b1c6, inset -3px -3px 6px #ffffff;
      }

      /* Results */
      .results-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }

      .result-item {
        background: var(--primary-bg);
        padding: 20px;
        border-radius: 15px;
        box-shadow: inset 4px 4px 8px #a3b1c6, inset -4px -4px 8px #ffffff;
        text-align: center;
      }

      .result-label {
        font-size: 13px;
        color: #777;
        margin-bottom: 8px;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .result-value {
        font-size: 26px;
        font-weight: 700;
        color: #2c3e50;
      }

      /* Charts */
      .charts-container {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 25px;
        margin-bottom: 30px;
      }

      .chart-wrapper {
        background: var(--primary-bg);
        padding: 25px;
        border-radius: 15px;
        box-shadow: 9px 9px 16px #a3b1c6, -9px -9px 16px #ffffff;
      }

      .chart-wrapper h3 {
        margin-bottom: 20px;
        color: #2c3e50;
        font-size: 18px;
      }

      /* Action Buttons */
      .action-buttons {
        display: flex;
        gap: 15px;
        flex-wrap: wrap;
        margin-bottom: 30px;
      }

      .action-btn {
        padding: 14px 28px;
        border: none;
        border-radius: 12px;
        background: var(--primary-bg);
        color: #555;
        font-size: 15px;
        font-weight: 600;
        cursor: pointer;
        box-shadow: 5px 5px 10px #a3b1c6, -5px -5px 10px #ffffff;
        transition: all 0.3s;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .action-btn:hover {
        box-shadow: 3px 3px 6px #a3b1c6, -3px -3px 6px #ffffff;
      }

      .action-btn:active {
        box-shadow: inset 3px 3px 6px #a3b1c6, inset -3px -3px 6px #ffffff;
      }

      /* Info Cards */
      .info-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 25px;
        margin-top: 30px;
      }

      .info-card {
        background: var(--primary-bg);
        padding: 25px;
        border-radius: 15px;
        border: 1px solid #9aa3af;
        box-shadow: 0px 0px 16px #a3b1c6, -9px -9px 16px #ffffff;
      }

      .info-card h3 {
        color: #2c3e50;
        margin-bottom: 15px;
        font-size: 18px;
      }

      .info-card p,
      .info-card ul {
        color: #555;
        line-height: 1.8;
        font-size: 14px;
      }

      .info-card ul {
        list-style: none;
        padding-left: 0;
      }

      .info-card li {
        padding-left: 25px;
        position: relative;
        margin-bottom: 10px;
      }

      .info-card li:before {
        content: "‚Ä¢";
        position: absolute;
        left: 10px;
        color: #e67e22;
        font-weight: bold;
      }

      /* Hidden Sections */
      .hidden {
        display: none;
      }

      .detailed-section,
      .calculation-steps {
        margin-top: 30px;
        padding: 25px;
        background: var(--primary-bg);
        border-radius: 15px;
        box-shadow: inset 4px 4px 8px #a3b1c6, inset -4px -4px 8px #ffffff;
      }

      .calculation-steps h3 {
        color: #2c3e50;
        margin-bottom: 15px;
      }

      .formula {
        background: #f5f7fa;
        padding: 15px;
        border-radius: 10px;
        margin: 15px 0;
        font-family: "Courier New", monospace;
        overflow-x: auto;
      }

      .cards {
        background: var(--primary-bg);
        padding: 20px;
        margin-top: 30px;
        border-radius: 20px;
        border: 1px solid #89929d;
        box-shadow: 0px 0px 16px #a3b1c6, -9px -9px 16px #ffffff;
      }

      .cards h2 {
        font-size: 22px;
        margin-bottom: 15px;
        color: #2c502e;
      }

      /* Summary Table Styling */
      .summary-table {
        margin-top: 8px;
        border-collapse: collapse;
        width: 100%;
        background: #f5f7fa;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0px 0px 8px #a3b1c6, -4px -4px 8px #ffffff;
      }

      .summary-table th {
        background: #e0e5ec;
        text-align: left;
        padding: 10px 14px;
        color: #e67e22;
        font-size: 15px;
        font-weight: 600;
        border-bottom: 1px solid #d1d9e6;
      }

      .summary-table th:nth-child(2) {
        color: #2980b9;
      }

      .summary-table th:nth-child(3) {
        color: #27ae60;
      }

      .summary-table td {
        padding: 10px 14px;
        font-size: 15px;
        color: #333;
        border-bottom: 1px solid #e0e5ec;
      }

      .summary-table tr:last-child td {
        border-bottom: none;
      }

      .summary-heading {
        color: #e67e22;
        font-size: 20px;
        margin-bottom: 18px;
        font-weight: 700;
        letter-spacing: 0.5px;
      }

      /* Responsive */
      @media (max-width: 480px) {
        .back-btn {
          display: none;
        }

        .icon-btn {
          width: 28px;
          height: 28px;
          font-size: 12px;
          border: 1px solid #9aa3af;
        }
      }

      @media (max-width: 768px) {
        .header h1 {
          font-size: 17px;
          margin-bottom: 3px;
        }

        .card {
          padding: 20px;
        }

        .btn-group {
          flex-direction: column;
        }

        .calculate-btn,
        .reset-btn {
          width: 100%;
        }

        .results-grid {
          grid-template-columns: 1fr;
        }

        .charts-container {
          grid-template-columns: 1fr;
        }
      }

      @media (min-width: 768px) {
        .main-content {
          grid-template-columns: 1fr 1fr;
        }

        .card.full-width {
          grid-column: 1 / -1;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Top Bar -->
      <div class="header">
        <button class="back-btn" onclick="window.location.href='../../home.html'">
          <span>‚Üê</span> Go Back
        </button>
        <div class="header-center">
          <h1>Retirement Calculator</h1>
        </div>
        <div class="header-actions">
          <button class="icon-btn" title="Share">üì§</button>
          <button class="icon-btn" title="Download PDF">üìÑ</button>
          <button class="icon-btn" title="Toggle Theme">üåì</button>
        </div>
      </div>

      <div class="main-content">
        <!-- Input Section -->
        <div class="card">
          <h2>Retirement Planning Details</h2>

          <div class="input-group">
            <label for="currentAge">Current Age</label>
            <input type="number" id="currentAge" value="30" min="18" max="100" step="1"/>
          </div>

          <div class="input-group">
            <label for="retirementAge">Retirement Age</label>
            <input type="number" id="retirementAge" value="60" min="40" max="100" step="1"/>
          </div>

          <div class="input-group">
            <label for="lifeExpectancy">Life Expectancy</label>
            <input type="number" id="lifeExpectancy" value="85" min="60" max="120" step="1"/>
          </div>

          <div class="input-group">
            <label for="monthlyExpense">Current Monthly Expenses</label>
            <input type="number" id="monthlyExpense" value="50000" min="1000" step="1000"/>
          </div>

          <div class="input-group">
            <label for="inflationRate">Inflation Rate (% per annum)</label>
            <input
              type="number"
              id="inflationRate"
              value="6"
              min="0"
              max="20"
              step="0.5"
            />
          </div>

          <div class="input-group">
            <label for="preReturnRate"
              >Pre-Retirement Return Rate (% p.a.)</label
            >
            <input
              type="number"
              id="preReturnRate"
              value="12"
              min="1"
              max="30"
              step="0.5"
            />
          </div>

          <div class="input-group">
            <label for="postReturnRate"
              >Post-Retirement Return Rate (% p.a.)</label
            >
            <input
              type="number"
              id="postReturnRate"
              value="8"
              min="1"
              max="20"
              step="0.5"
            />
          </div>

          <div class="input-group">
            <label for="currentSavings">Current Savings/Corpus</label>
            <input
              type="number"
              id="currentSavings"
              value="500000"
              min="0"
              step="10000"
            />
          </div>

          <div class="input-group">
            <label for="currency">Currency</label>
            <select id="currency">
              <option value="‚Çπ">INR (‚Çπ)</option>
              <option value="$">USD ($)</option>
              <option value="‚Ç¨">EUR (‚Ç¨)</option>
              <option value="¬£">GBP (¬£)</option>
            </select>
          </div>

          <div class="btn-group">
            <button class="calculate-btn" onclick="calculateRetirement()">
              Calculate Retirement Plan
            </button>
            <button class="reset-btn" onclick="resetForm()">Reset</button>
          </div>
        </div>

        <!-- Quick Info -->
        <div class="card">
          <h2>Quick Tips</h2>
          <div style="color: #555; line-height: 1.8">
            <p style="margin-bottom: 15px">
              üèñÔ∏è <strong>Start Early:</strong> The earlier you start saving, the
              more time your money has to grow through compounding.
            </p>
            <p style="margin-bottom: 15px">
              üí∞ <strong>Rule of 25:</strong> Multiply your annual expenses by
              25 to get your retirement corpus target.
            </p>
            <p style="margin-bottom: 15px">
              üìä <strong>Inflation Impact:</strong> At 6% inflation, prices
              double every 12 years. Plan accordingly!
            </p>
            <p style="margin-bottom: 15px">
              üéØ <strong>4% Rule:</strong> You can withdraw 4% of your corpus
              annually in retirement without running out.
            </p>
          </div>
        </div>
      </div>

      <!-- Results Section -->
      <div class="cards full-width hidden" id="resultsSection">
        <h2>Your Retirement Summary</h2>

        <div class="results-grid">
          <div class="result-item">
            <div class="result-label">Years to Retirement</div>
            <div class="result-value" id="yearsToRetirement">-</div>
          </div>
          <div class="result-item">
            <div class="result-label">Required Corpus</div>
            <div class="result-value" id="requiredCorpus">-</div>
          </div>
          <div class="result-item">
            <div class="result-label">Monthly Savings Needed</div>
            <div class="result-value" id="monthlySavings">-</div>
          </div>
          <div class="result-item">
            <div class="result-label">Monthly Income at Retirement</div>
            <div
              class="result-value"
              id="monthlyIncome"
              style="font-size: 18px"
            >
              -
            </div>
          </div>
        </div>

        <!-- Charts -->
        <div class="charts-container">
          <div class="chart-wrapper">
            <h3>Corpus Growth Over Time</h3>
            <canvas id="lineChart"></canvas>
          </div>
          <div class="chart-wrapper">
            <h3>Retirement Corpus Breakdown</h3>
            <canvas id="pieChart"></canvas>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="action-buttons">
          <button class="action-btn">üìÑ Download Report</button>
          <button class="action-btn" onclick="toggleDetailedBreakdown()">
            üìä View Detailed Breakdown
          </button>
          <button class="action-btn" onclick="toggleSteps()">
            üßÆ Show Calculation Steps
          </button>
        </div>

        <!-- Detailed Breakdown -->
        <div class="detailed-section hidden" id="detailedSection">
          <h3>Year-wise Projection</h3>
          <div id="yearWiseTable"></div>
        </div>

        <!-- Calculation Steps -->
        <div class="calculation-steps hidden" id="calculationSteps">
          <h3>Step-by-Step Calculation</h3>
          <div class="formula">
            <strong>Future Value of Expenses:</strong><br />
            FV = PV √ó (1 + inflation_rate)^years<br /><br />
            <strong>Required Retirement Corpus:</strong><br />
            Corpus = (Monthly_Expense √ó 12 √ó Years_in_Retirement) / (1 - (1 / (1
            + post_return)^years))<br /><br />
            <strong>Monthly SIP Required:</strong><br />
            SIP = (Target - Current_Savings √ó (1 + r)^n) / [{(1 + r)^n - 1} / r]
          </div>
          <div
            id="calculationExample"
            style="margin-top: 15px; color: #555; line-height: 1.8"
          ></div>
        </div>
      </div>

      <!-- Info Cards -->
      <div class="info-cards">
        <div class="info-card">
          <h3>How to Use the Retirement Calculator</h3>
          <ul>
            <li>Enter your current age and desired retirement age</li>
            <li>
              Input your expected life expectancy (average is 75-85 years)
            </li>
            <li>Add your current monthly expenses</li>
            <li>Set realistic inflation rate (typically 5-7% in India)</li>
            <li>
              Enter expected returns (higher before retirement, conservative
              after)
            </li>
            <li>Add any existing savings or corpus</li>
            <li>Click calculate to see your retirement plan</li>
          </ul>
        </div>

        <div class="info-card">
          <h3>What is Retirement Planning?</h3>
          <p>
            Retirement planning involves determining retirement income goals and
            the actions necessary to achieve those goals. It includes
            identifying sources of income, estimating expenses, implementing a
            savings program, and managing assets.
          </p>
          <p style="margin-top: 15px">
            <strong>Example:</strong> If you're 30 and want to retire at 60 with
            ‚Çπ50,000 monthly expenses (today's value), accounting for 6%
            inflation, you'll need approximately ‚Çπ2.87 crores at retirement!
          </p>
        </div>

        <div class="info-card">
          <h3>Key Retirement Planning Principles</h3>
          <ul>
            <li>Start as early as possible - time is your biggest asset</li>
            <li>Account for inflation in your calculations</li>
            <li>Diversify investments across asset classes</li>
            <li>Have health insurance and emergency funds</li>
            <li>Review and adjust your plan annually</li>
            <li>Consider healthcare costs - they rise faster than inflation</li>
            <li>Don't forget about taxes on withdrawals</li>
          </ul>
        </div>
      </div>
    </div>

    <script>
      // Chart instances
      let pieChart, lineChart;

      // Reset Form
      function resetForm() {
        document.getElementById("currentAge").value = 30;
        document.getElementById("retirementAge").value = 60;
        document.getElementById("lifeExpectancy").value = 85;
        document.getElementById("monthlyExpense").value = 50000;
        document.getElementById("inflationRate").value = 6;
        document.getElementById("preReturnRate").value = 12;
        document.getElementById("postReturnRate").value = 8;
        document.getElementById("currentSavings").value = 500000;
        document.getElementById("currency").value = "‚Çπ";
        document.getElementById("resultsSection").classList.add("hidden");
        document.getElementById("detailedSection").classList.add("hidden");
        document.getElementById("calculationSteps").classList.add("hidden");

        // Reset quick tips card to original content
        resetQuickTips();
      }

      // Reset Quick Tips to Original
      function resetQuickTips() {
        const quickTipsCard = document.querySelectorAll(".card")[1];
        quickTipsCard.innerHTML = `
    <h2>Quick Tips</h2>
    <div style="color: #555; line-height: 1.8">
      <p style="margin-bottom: 15px">
        üèñÔ∏è <strong>Start Early:</strong> The earlier you start saving, the more time your money has to grow through compounding.
      </p>
      <p style="margin-bottom: 15px">
        üí∞ <strong>Rule of 25:</strong> Multiply your annual expenses by 25 to get your retirement corpus target.
      </p>
      <p style="margin-bottom: 15px">
        üìä <strong>Inflation Impact:</strong> At 6% inflation, prices double every 12 years. Plan accordingly!
      </p>
      <p style="margin-bottom: 15px">
        üéØ <strong>4% Rule:</strong> You can withdraw 4% of your corpus annually in retirement without running out.
      </p>
    </div>
  `;
      }

      // Show Summary in Quick Tips
      function showSummaryInQuickTips(yearWise, curr, inflationRate) {
        let totalYears = yearWise.length;
        let gap = 1;

        if (totalYears > 30) gap = 5;
        else if (totalYears > 15) gap = 3;
        else if (totalYears > 10) gap = 2;

        // Filter rows by gap
        let yearRows = yearWise
          .map((y, idx) => {
            if (
              y.year === 1 || // Always show first year
              y.year === totalYears || // Always show last year
              y.year % gap === 0 // Show at gap interval
            ) {
              return `<tr>
          <td>Year ${y.year}</td>
          <td>${curr} ${Math.round(y.savings).toLocaleString()}</td>
          <td>${curr} ${Math.round(y.corpus).toLocaleString()}</td>
        </tr>`;
            }
            return "";
          })
          .filter(Boolean)
          .join("");

        const quickTipsCard = document.querySelectorAll(".card")[1];
        quickTipsCard.innerHTML = `
    <h2 class="summary-heading">
      Year-wise Savings Projection [${inflationRate}% inflation]
    </h2>
    <div style="margin-top:18px;">
      <table class="summary-table">
        <thead>
          <tr>
            <th>Year</th>
            <th>Annual Savings</th>
            <th>Total Corpus</th>
          </tr>
        </thead>
        <tbody>
          ${yearRows}
        </tbody>
      </table>
      <div style="color:#777; font-size:13px; margin-top:8px;">
        ${
          gap > 1
            ? `Showing every ${gap} years, plus first & last year.`
            : "Year-wise details shown."
        }
      </div>
    </div>
  `;
      }

      // Calculate Retirement
      function calculateRetirement() {
        // Get inputs
        let currentAge = parseInt(document.getElementById("currentAge").value);
        let retirementAge = parseInt(
          document.getElementById("retirementAge").value
        );
        let lifeExpectancy = parseInt(
          document.getElementById("lifeExpectancy").value
        );
        let monthlyExpense = parseFloat(
          document.getElementById("monthlyExpense").value
        );
        let inflationRate =
          parseFloat(document.getElementById("inflationRate").value) / 100;
        let preReturnRate =
          parseFloat(document.getElementById("preReturnRate").value) / 100;
        let postReturnRate =
          parseFloat(document.getElementById("postReturnRate").value) / 100;
        let currentSavings = parseFloat(
          document.getElementById("currentSavings").value
        );
        let curr = document.getElementById("currency").value;

        // Validate inputs
        if (retirementAge <= currentAge) {
          alert("Retirement age must be greater than current age!");
          return;
        }
        if (lifeExpectancy <= retirementAge) {
          alert("Life expectancy must be greater than retirement age!");
          return;
        }

        // Calculate years
        let yearsToRetirement = retirementAge - currentAge;
        let yearsInRetirement = lifeExpectancy - retirementAge;

        // Future value of monthly expenses at retirement (adjusted for inflation)
        let futureMonthlyExpense =
          monthlyExpense * Math.pow(1 + inflationRate, yearsToRetirement);

        // Calculate required corpus
        // Using present value of annuity formula adjusted for inflation
        let monthlyPostReturn = postReturnRate / 12;
        let monthlyInflation = inflationRate / 12;
        let realReturn = monthlyPostReturn - monthlyInflation;
        let monthsInRetirement = yearsInRetirement * 12;

        let requiredCorpus;
        if (realReturn > 0.0001) {
          // PV of growing annuity
          requiredCorpus =
            futureMonthlyExpense *
            12 *
            ((1 -
              Math.pow(
                (1 + monthlyInflation) / (1 + monthlyPostReturn),
                yearsInRetirement
              )) /
              (monthlyPostReturn - monthlyInflation));
        } else {
          // Simple multiplication if real return is near zero
          requiredCorpus = futureMonthlyExpense * monthsInRetirement;
        }

        // Future value of current savings at retirement
        let futureValueOfSavings =
          currentSavings * Math.pow(1 + preReturnRate, yearsToRetirement);

        // Gap to fill
        let corpusGap = requiredCorpus - futureValueOfSavings;

        // Calculate monthly SIP needed using future value of annuity formula
        let monthlyReturn = preReturnRate / 12;
        let monthsToRetirement = yearsToRetirement * 12;

        let monthlySIP;
        if (corpusGap > 0) {
          if (monthlyReturn > 0) {
            monthlySIP =
              corpusGap /
              (((Math.pow(1 + monthlyReturn, monthsToRetirement) - 1) /
                monthlyReturn) *
                (1 + monthlyReturn));
          } else {
            monthlySIP = corpusGap / monthsToRetirement;
          }
        } else {
          monthlySIP = 0; // Already have enough
        }

        // Calculate monthly income at retirement (4% rule adjusted)
        let monthlyIncomeAtRetirement = requiredCorpus * (postReturnRate / 12);

        // Generate year-wise data for charts
        let yearWise = [];
        let currentCorpus = currentSavings;

        for (let i = 1; i <= yearsToRetirement; i++) {
          // Annual savings (12 months of SIP)
          let annualSaving = monthlySIP * 12;

          // Corpus grows with returns and additions
          currentCorpus = currentCorpus * (1 + preReturnRate) + annualSaving;

          yearWise.push({
            year: i,
            age: currentAge + i,
            savings: annualSaving,
            corpus: currentCorpus,
          });
        }

        // Display results
        document.getElementById("yearsToRetirement").textContent =
          yearsToRetirement + " years";
        document.getElementById("requiredCorpus").textContent =
          curr +
          " " +
          requiredCorpus.toLocaleString(undefined, {
            maximumFractionDigits: 0,
          });
        document.getElementById("monthlySavings").textContent =
          curr +
          " " +
          monthlySIP.toLocaleString(undefined, { maximumFractionDigits: 0 });
        document.getElementById("monthlyIncome").textContent =
          curr +
          " " +
          futureMonthlyExpense.toLocaleString(undefined, {
            maximumFractionDigits: 0,
          });

        // Show results section
        document.getElementById("resultsSection").classList.remove("hidden");

        // Draw charts
        drawPieChart(futureValueOfSavings, corpusGap > 0 ? corpusGap : 0, curr);
        drawLineChart(yearWise, curr);

        // Show summary in Quick Tips
        showSummaryInQuickTips(
          yearWise,
          curr,
          (inflationRate * 100).toFixed(1)
        );

        // Generate calculation example
        let calculationHTML = `
    <strong>Inputs:</strong><br>
    Current Age: ${currentAge} years<br>
    Retirement Age: ${retirementAge} years<br>
    Life Expectancy: ${lifeExpectancy} years<br>
    Current Monthly Expense: ${curr} ${monthlyExpense.toLocaleString()}<br>
    Inflation Rate: ${(inflationRate * 100).toFixed(1)}%<br>
    Pre-Retirement Return: ${(preReturnRate * 100).toFixed(1)}%<br>
    Post-Retirement Return: ${(postReturnRate * 100).toFixed(1)}%<br>
    Current Savings: ${curr} ${currentSavings.toLocaleString()}<br><br>
    
    <strong>Calculations:</strong><br>
    Years to Retirement: ${yearsToRetirement} years<br>
    Years in Retirement: ${yearsInRetirement} years<br>
    Future Monthly Expense: ${curr} ${futureMonthlyExpense.toLocaleString(
          undefined,
          { maximumFractionDigits: 0 }
        )}<br>
    Required Retirement Corpus: ${curr} ${requiredCorpus.toLocaleString(
          undefined,
          { maximumFractionDigits: 0 }
        )}<br>
    Future Value of Current Savings: ${curr} ${futureValueOfSavings.toLocaleString(
          undefined,
          { maximumFractionDigits: 0 }
        )}<br>
    Corpus Gap to Fill: ${curr} ${Math.max(0, corpusGap).toLocaleString(
          undefined,
          { maximumFractionDigits: 0 }
        )}<br>
    Monthly SIP Required: ${curr} ${monthlySIP.toLocaleString(undefined, {
          maximumFractionDigits: 0,
        })}<br><br>
    
    <strong>Result:</strong><br>
    By saving ${curr} ${monthlySIP.toLocaleString(undefined, {
          maximumFractionDigits: 0,
        })} per month for ${yearsToRetirement} years at ${(
          preReturnRate * 100
        ).toFixed(1)}% return, 
    you'll accumulate ${curr} ${requiredCorpus.toLocaleString(undefined, {
          maximumFractionDigits: 0,
        })} by age ${retirementAge}. 
    This will provide you approximately ${curr} ${futureMonthlyExpense.toLocaleString(
          undefined,
          { maximumFractionDigits: 0 }
        )} per month 
    (adjusted for inflation) throughout your retirement until age ${lifeExpectancy}.
  `;
        document.getElementById("calculationExample").innerHTML =
          calculationHTML;

        // Generate detailed year-wise table
        generateDetailedTable(
          yearWise,
          curr,
          retirementAge,
          lifeExpectancy,
          requiredCorpus,
          postReturnRate,
          inflationRate
        );
      }

      // Draw Pie Chart
      function drawPieChart(existingSavings, additionalNeeded, curr) {
        let ctx = document.getElementById("pieChart").getContext("2d");
        if (pieChart) pieChart.destroy();

        let labels =
          additionalNeeded > 0
            ? ["Current Savings Growth", "Additional Savings Needed"]
            : ["Current Savings (Sufficient)"];

        let data =
          additionalNeeded > 0
            ? [existingSavings, additionalNeeded]
            : [existingSavings];

        let colors =
          additionalNeeded > 0 ? ["#27ae60", "#e67e22"] : ["#27ae60"];

        pieChart = new Chart(ctx, {
          type: "doughnut",
          data: {
            labels: labels,
            datasets: [
              {
                data: data,
                backgroundColor: colors,
              },
            ],
          },
          options: {
            plugins: {
              legend: { display: true, position: "bottom" },
              tooltip: {
                callbacks: {
                  label: function (context) {
                    let label = context.label || "";
                    let value = context.parsed || 0;
                    return (
                      label +
                      ": " +
                      curr +
                      " " +
                      value.toLocaleString(undefined, {
                        maximumFractionDigits: 0,
                      })
                    );
                  },
                },
              },
            },
          },
        });
      }

      // Draw Line Chart
      function drawLineChart(yearWise, curr) {
        let ctx = document.getElementById("lineChart").getContext("2d");
        if (lineChart) lineChart.destroy();

        lineChart = new Chart(ctx, {
          type: "line",
          data: {
            labels: yearWise.map((y) => "Year " + y.year),
            datasets: [
              {
                label: "Total Corpus (" + curr + ")",
                data: yearWise.map((y) => y.corpus),
                borderColor: "#e67e22",
                backgroundColor: "rgba(230,126,34,0.1)",
                fill: true,
                tension: 0.4,
              },
            ],
          },
          options: {
            plugins: {
              legend: { display: true, position: "top" },
              tooltip: {
                callbacks: {
                  label: function (context) {
                    let value = context.parsed.y || 0;
                    return (
                      "Corpus: " +
                      curr +
                      " " +
                      value.toLocaleString(undefined, {
                        maximumFractionDigits: 0,
                      })
                    );
                  },
                },
              },
            },
            scales: {
              y: {
                beginAtZero: true,
                ticks: {
                  callback: function (value) {
                    return curr + " " + value / 1000 + "K";
                  },
                },
              },
            },
          },
        });
      }

      // Generate Detailed Year-wise Table
      function generateDetailedTable(
        yearWise,
        curr,
        retirementAge,
        lifeExpectancy,
        corpus,
        postReturn,
        inflation
      ) {
        let tableHTML = `
    <h4 style="margin-bottom: 15px; color: #2c3e50;">Accumulation Phase (Pre-Retirement)</h4>
    <table class="summary-table" style="margin-bottom: 30px;">
      <thead>
        <tr>
          <th>Year</th>
          <th>Age</th>
          <th>Annual Savings</th>
          <th>Total Corpus</th>
        </tr>
      </thead>
      <tbody>
  `;

        yearWise.forEach((y) => {
          tableHTML += `
      <tr>
        <td>Year ${y.year}</td>
        <td>${y.age}</td>
        <td>${curr} ${Math.round(y.savings).toLocaleString()}</td>
        <td>${curr} ${Math.round(y.corpus).toLocaleString()}</td>
      </tr>
    `;
        });

        tableHTML += `
      </tbody>
    </table>
  `;

        // Retirement phase projection
        let yearsInRetirement = lifeExpectancy - retirementAge;
        let currentCorpus = corpus;
        let monthlyWithdrawal = corpus * (postReturn / 12);

        tableHTML += `
    <h4 style="margin-bottom: 15px; color: #2c3e50;">Distribution Phase (Retirement Years)</h4>
    <table class="summary-table">
      <thead>
        <tr>
          <th>Year</th>
          <th>Age</th>
          <th>Annual Withdrawal</th>
          <th>Remaining Corpus</th>
        </tr>
      </thead>
      <tbody>
  `;

        let gap = yearsInRetirement > 15 ? 3 : yearsInRetirement > 10 ? 2 : 1;

        for (let i = 1; i <= yearsInRetirement; i++) {
          let age = retirementAge + i;
          let annualWithdrawal =
            monthlyWithdrawal * 12 * Math.pow(1 + inflation, i);
          currentCorpus = currentCorpus * (1 + postReturn) - annualWithdrawal;

          if (i === 1 || i === yearsInRetirement || i % gap === 0) {
            tableHTML += `
        <tr>
          <td>Year ${i}</td>
          <td>${age}</td>
          <td>${curr} ${Math.round(annualWithdrawal).toLocaleString()}</td>
          <td>${curr} ${Math.round(
              Math.max(0, currentCorpus)
            ).toLocaleString()}</td>
        </tr>
      `;
          }
        }

        tableHTML += `
      </tbody>
    </table>
    <div style="color:#777; font-size:13px; margin-top:8px;">
      ${
        gap > 1
          ? `Showing every ${gap} years, plus first & last year.`
          : "Year-wise retirement details shown."
      }
    </div>
  `;

        document.getElementById("yearWiseTable").innerHTML = tableHTML;
      }

      // Toggle Detailed Breakdown
      function toggleDetailedBreakdown() {
        document.getElementById("detailedSection").classList.toggle("hidden");
      }

      // Toggle Calculation Steps
      function toggleSteps() {
        document.getElementById("calculationSteps").classList.toggle("hidden");
      }

      // Initial State on Load
      window.onload = function () {
        resetForm();
        window.scrollTo(0, 0);
      };

      // Fix: Reset form on page refresh/reload and scroll to top
      window.addEventListener("pageshow", function (event) {
        if (event.persisted || performance.navigation.type === 1) {
          resetForm();
          window.scrollTo(0, 0);
        }
      });
    </script>
  </body>
</html>
